<title>Le Grattoir - vma1991.net</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>@media screen and (max-width:760px){div.page{display:grid;grid-template-columns:1fr;grid-template-rows:auto}div.tabbed_pane{display:grid;grid-template-columns:1fr;grid-template-rows:auto}}@media screen and (min-width:761px){h1.grattoirHeading{font-size:3em}div.page{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:auto}div.tabbed_pane{display:grid;grid-template-columns:1fr 3fr;grid-template-rows:auto}div.tabbed_pane_menu{display:flex;flex-direction:column}}div{margin:2px;padding:2px}div.grattoir{display:grid;grid-template-columns:minmax(auto,1200px);grid-template-rows:auto}div.loading{display:block;top:0;left:0;margin:0;position:absolute;z-index:10;background-color:#fff;width:100%;height:100%;box-sizing:border-box}div.tabbed_pane{display:none}</style><script src=https://cdn.plot.ly/plotly-2.20.0.min.js></script><div class=loading id=loadingDiv></div><div class=grattoir id=grattoirDiv><h1 class=grattoirHeading>&#x1D577;&#x1D58A; &#x1D572;&#x1D597;&#x1D586;&#x1D599;&#x1D599;&#x1D594;&#x1D58E;&#x1D597;
<a href=# id=settingsGearA>&#9881;</a></h1><marquee>Toute l'information de seconde main par des procédés à l'éthique parfois discutable</marquee><div class=page id=grattoirPage><div class=page_sub><h2>Wikipedia</h2><p id=wikipedia></div><div class=page_sub><h2 id=trendsH2>Google queries</h2><p id=google></div><div class=page_sub><h2 id=bleuH2>France Bleu</h2><p id=bleu></div><div class=page_sub><h2 id=customH2></h2><p id=custom></div><div class=page_sub><h2>Hydrométrie</h2><span id=hydroName></span><div id=hydroPlot></div></div><div class=page_sub><h2>Le Monde</h2><p id=leMonde></div><div class=page_sub><h2>Courrier International</h2><p id=courrier></div><div class=page_sub><h2>IGN France</h2><p id=ign></div><div class=page_sub><h2>CNET</h2><p id=cnet></div></div><div class=tabbed_pane id=settingsPane><div class=tabbed_pane_menu><a href=# id=trendsSettingsA>Google trends</a>
<a href=# id=rssSettingsA>RSS</a>
<a href=# id=hydroSettingsA>Hydrométrie</a>
<span>&nbsp;&nbsp;&nbsp;</span>
<a href=# id=defaultsA>Restore Defaults</a>
<a href=# id=closeSettingsA>Close</a></div><div class=tabbed_pane_tab id=trendsSettingsTab><h2>Google trends</h2><p><select id=trendsRegionSelect><option value=AR>Argentina<option value=AT>Austria<option value=AU>Australia<option value=BE>Belgium<option value=BR>Brazil<option value=CA>Canada<option value=CH>Switzerland<option value=CL>Chile<option value=CO>Colombia<option value=CZ>Czechia<option value=DE>Germany<option value=DK>Denmark<option value=EG>Egypt<option value=FI>Finland<option value=FR>France<option value=GB>Great Britain<option value=GR>Greece<option value=HK>Hong Kong<option value=HU>Hungaria<option value=ID>Indonesia<option value=IE>Ireland<option value=IL>Israel<option value=IN>India<option value=IT>Italia<option value=JP>Japan<option value=KE>Kenya<option value=KR>South Korea<option value=MX>Mexico<option value=MY>Malaysia<option value=NG>Nigeria<option value=NL>Netherlands<option value=NO>Norway<option value=NZ>New Zealand<option value=PH>Philippines<option value=PL>Poland<option value=PT>Portugal<option value=RO>Romania<option value=RU>Russia<option value=SA>Saudi Arabia<option value=SE>Sweden<option value=SG>Singapore<option value=TH>Thailand<option value=TR>Turkey<option value=TW>Taiwan<option value=UA>Ukraine<option value=US>United States<option value=VN>Vietnam<option value=ZA>South Africa</select>
<button id=saveTrendsSettings>Save region</button>
<span id=trendsSettingsMessage></span><p id=savedTrendsSettings></div><div class=tabbed_pane_tab style=display:none id=rssSettingsTab><h2>Flux RSS</h2><h3>France Bleu</h3><p><select id=bleuEditionSelect><option value=alsace>Alsace<option value=armorique>Armorique<option value=auxerre>Auxerre<option value=azur>Azur<option value=bearn>Béarn Bigorre<option value=belfort-montbeliard>Belfort Montbéliard<option value=berry>Berry<option value=besancon>Besançon<option value=bourgogne>Bourgogne<option value=breizh-izel>Breizh Izel<option value=champagne-ardenne>Champagne Ardenne<option value=cotentin>Cotentin<option value=creuse>Creuse<option value=drome-ardeche>Drôme Ardèche<option value=elsass>Elsass<option value=gard-lozere>Gard Lozère<option value=gascogne>Gascogne<option value=gironde>Gironde<option value=herault>Hérault<option value=isere>Isère<option value=la-rochelle>La Rochelle<option value=limousin>Limousin<option value=loire-ocean>Loire Océan<option value=lorraine-nord>Lorraine Nord<option value=maine>Maine<option value=mayenne>Mayenne<option value=nord>Nord<option value=normandie-caen>Normandie (Calvados - Orne)<option value=normandie-rouen>Normandie (Seine-Maritime - Eure)<option value=toulouse>Occitanie<option value=orleans>Orléans<option value=107-1>Paris<option value=pays-basque>Pays Basque<option value=pays-d-auvergne>Pays d'Auvergne<option value=pays-de-savoie>Pays de Savoie<option value=perigord>Périgord<option value=picardie>Picardie<option value=poitou>Poitou<option value=provence>Provence<option value=rcfm>RCFM<option value=roussillon>Roussillon<option value=saint-etienne-loire>Saint-Étienne Loire<option value=sud-lorraine>Sud Lorraine<option value=touraine>Touraine<option value=vaucluse>Vaucluse</select>
<button id=saveBleuSettings>Save edition</button>
<span id=bleuSettingsMessage></span><p id=savedBleuSettings><hr><h3>Custom Flux</h3><p>Name <input id=customRssNameInput size=25 maxlength=150><br>URL <input id=customRssUrlInput size=25 maxlength=150><br><button id=saveCustomRss>Save custom RSS</button>
<span id=customRssMessage></span><p id=savedCustomRss></div><div class=tabbed_pane_tab style=display:none id=hydroSettingsTab><h2>API Hub'Eau - Hydrométrie</h2><p><button type=button id=locationSites>Get sites around location</button>
<span id=locationMessage></span><br><button type=button id=customLocationSites>Get sites around coordinates</button> -
Lat : <input id=customLocationLat size=6> - Lon : <input id=customLocationLon size=6>
<span id=customLocationMessage></span><br><select id=locationSitesRadius><option value=30>30<option value=40>40<option value=50>50</select>
km radius<hr><p>Select site :<p id=hydroSites><p><button type=button id=siteStations>Get stations for selected site</button><hr><p>Select station :<p id=hydroStations><p><button type=button id=saveHydroSettings>Save station settings</button>
<span id=hydroSettingsMessage></span><hr><p id=savedHydroSettings></div></div></div><script>async function grattoirEntry(){for(var d=prompt();!d||btoa(d)!="U2ljaHVhbg==";)d=prompt();const l=document.getElementById("grattoirPage"),E=document.getElementById("settingsPane");function k(){u(),a("trendsSettingsTab"),l.style.display=="none"?(l.style.display="grid",E.style.display="none"):(l.style.display="none",E.style.display="grid")}async function S(){const b=document.getElementById("wikipedia"),m=document.getElementById("google"),f=document.getElementById("bleu"),p=document.getElementById("custom"),h=document.getElementById("leMonde"),j=document.getElementById("courrier"),u=document.getElementById("ign"),v=document.getElementById("cnet"),g=document.getElementById("hydroName"),w=document.getElementById("hydroPlot"),O=document.getElementById("trendsH2"),x=document.getElementById("bleuH2"),_=document.getElementById("customH2"),t="WyrOO89gQi";b.innerHTML="&#9203;";var s,o,i,a,r,c,l,d,y,e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"random_page"}});await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t='<a href="'+e.url+'" target="_blank">'+e.title+"</a> - "+e.summary;b.innerHTML=t}).catch(e=>b.innerHTML=e),m.innerHTML="&#9203;",d=localStorage.getItem("trendsRegionName"),d==null&&(d="France"),l=localStorage.getItem("trendsRegionId"),l==null&&(l="FR"),e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"daily_trends","arg-0":l}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{for(var n="<ul>",t=0;t<e.length;t++)n+='<li><a href="'+e[t].url+'" target="_blank">'+e[t].query+"</a></li>";n+="</ul>",m.innerHTML=n,O.innerHTML="Google queries "+d}).catch(e=>m.innerHTML=e);function n(e){try{for(var n="<ul>",t=0;t<e.length;t++)n+='<li><a href="'+e[t].link+'" target="_blank">'+e[t].title+"</a></li>"}catch(e){n=e}return n}f.innerHTML="&#9203;",c=localStorage.getItem("bleuEditionName"),c==null&&(c="Bourgogne"),r=localStorage.getItem("bleuEditionId"),r==null&&(r="bourgogne"),y="https://www.francebleu.fr/rss/"+r+"/a-la-une.xml",e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":y,"arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);f.innerHTML=t,x.innerHTML="France Bleu "+c}).catch(e=>f.innerHTML=e),p.innerHTML="&#9203;",a=localStorage.getItem("customRssName"),a==null&&(a="Mairie Semur en Auxois"),i=localStorage.getItem("customRssUrl"),i==null&&(i="https://www.ville-semur-en-auxois.fr/feed/?post_type=post"),e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":i,"arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);p.innerHTML=t,_.innerHTML=a}).catch(e=>p.innerHTML=e),h.innerHTML="&#9203;",e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":"https://www.lemonde.fr/rss/une.xml","arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);h.innerHTML=t}).catch(e=>h.innerHTML=e),j.innerHTML="&#9203;",e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":"https://www.courrierinternational.com/feed/all/rss.xml","arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);j.innerHTML=t}).catch(e=>j.innerHTML=e),u.innerHTML="&#9203;",e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":"https://fr.ign.com/feed.xml","arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);u.innerHTML=t}).catch(e=>u.innerHTML=e),v.innerHTML="&#9203;",e=new Request("http://141.145.208.108/transmitter",{headers:{apikey:t,signal:"rss_headlines","arg-0":"https://www.cnet.com/rss/news/","arg-1":"7"}}),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t=n(e);v.innerHTML=t}).catch(e=>v.innerHTML=e),g.innerHTML="&#9203;",o=localStorage.getItem("hydroStationId"),o==null&&(o="F330000101"),s=localStorage.getItem("hydroStationName"),s==null&&(s="L'Armançon à Pont-et-Massène [Barrage] - Aval barrage"),e=new Request("https://hubeau.eaufrance.fr/api/v1/hydrometrie/observations_tr?code_entite="+o+"&grandeur_hydro=H"),await fetch(e).then(e=>{if(e<0)throw new Error(e);return e.json()}).then(e=>{var t,i,a,r,c,n=[],o=[];for(n.push(e.data[0].date_obs.replace("T"," ").replace("Z","")),o.push(e.data[0].resultat_obs),i=new Date(e.data[0].date_obs),t=1;t<e.data.length;)a=new Date(e.data[t].date_obs),(i-a)/1e3>=3600?(n.push(e.data[t].date_obs.replace("T"," ").replace("Z","")),o.push(e.data[t].resultat_obs),i=new Date(e.data[t].date_obs),t++):t++;r={x:n,y:o},c={title:"H (mm)"},n=n.reverse(),o=o.reverse(),g.innerHTML=s,Plotly.newPlot(w,[r],c)}).catch(e=>g.innerHTML=e)}const o=document.getElementById("trendsRegionSelect"),T=document.getElementById("saveTrendsSettings"),m=document.getElementById("savedTrendsSettings"),c=document.getElementById("trendsSettingsMessage");function _(){try{var e=localStorage.getItem("trendsRegionName");e==null?m.innerHTML="No saved region":m.innerHTML="Currently saved region :<br>"+e}catch(e){m.innerHTML="Saved settings error :<br>"+e}}T.addEventListener("click",e=>{c.innerHTML="&#9203;";try{var n=o.options[o.selectedIndex].innerHTML,t=o.value;localStorage.setItem("trendsRegionName",n),localStorage.setItem("trendsRegionId",t)}catch{c.innerHTML="Save error";return}c.innerHTML="Settings saved",o.selectedIndex=0,_()});const n=document.getElementById("bleuEditionSelect"),N=document.getElementById("saveBleuSettings"),h=document.getElementById("savedBleuSettings"),r=document.getElementById("bleuSettingsMessage"),f=document.getElementById("customRssNameInput"),p=document.getElementById("customRssUrlInput"),V=document.getElementById("saveCustomRss"),v=document.getElementById("savedCustomRss"),s=document.getElementById("customRssMessage");function C(){try{var e=localStorage.getItem("bleuEditionName");e==null?h.innerHTML="No saved edition":h.innerHTML="Currently saved edition :<br>"+e}catch(e){h.innerHTML="Saved settings error :<br>"+e}}function w(){try{var e=localStorage.getItem("customRssUrl"),t=localStorage.getItem("customRssName");e==null?v.innerHTML="No saved flux":v.innerHTML="Currently saved flux :<br>"+t+"<br>"+e}catch(e){v.innerHTML="Saved settings error :<br>"+e}}N.addEventListener("click",e=>{r.innerHTML="&#9203;";try{var s=n.options[n.selectedIndex].innerHTML,t=n.value;localStorage.setItem("bleuEditionName",s),localStorage.setItem("bleuEditionId",t)}catch{r.innerHTML="Save error";return}r.innerHTML="Settings saved",n.selectedIndex=0,C()}),V.addEventListener("click",e=>{s.innerHTML="&#9203;";var t=f.value,n=p.value;try{customRssUrl=new URL(n)}catch{s.innerHTML="URL Error";return}t==""&&(t="Custom Rss");try{localStorage.setItem("customRssUrl",customRssUrl.href),localStorage.setItem("customRssName",t)}catch{s.innerHTML="Save error";return}s.innerHTML="Settings saved",f.value="",p.value="",w()});const z=document.getElementById("locationSites"),y=document.getElementById("locationSitesRadius"),O=document.getElementById("locationMessage"),W=document.getElementById("customLocationSites"),j=document.getElementById("customLocationLat"),g=document.getElementById("customLocationLon"),B=document.getElementById("customLocationMessage"),e=document.getElementById("hydroSites"),P=document.getElementById("siteStations"),t=document.getElementById("hydroStations"),F=document.getElementById("saveHydroSettings"),i=document.getElementById("hydroSettingsMessage"),b=document.getElementById("savedHydroSettings"),D={maximumAge:1e4,timeout:5e3,enableHighAccuracy:!0};function A(){try{var e=localStorage.getItem("hydroStationName");e==null?b.innerHTML="No saved station":b.innerHTML="Currently saved station :<br>"+e}catch(e){b.innerHTML="Saved settings error :<br>"+e}}z.addEventListener("click",t=>{var n=y.value;O.innerHTML="",e.innerHTML="&#9203;",navigator.geolocation.getCurrentPosition(t=>{crd=t.coords,lat=crd.latitude,lon=crd.longitude;var s="https://hubeau.eaufrance.fr/api/v1/hydrometrie/referentiel/sites?latitude="+lat+"&longitude="+lon+"&distance="+n;const o=new Request(s);fetch(o).then(e=>{if(!e.ok)throw new Error("Request error");return e.json()}).then(t=>{if(t.data.length==0){hydrosites.innerHTML="No sites found";return}for(var s='<select id="siteSelect">',n=0;n<t.data.length;n++)s+='<option value="'+t.data[n].code_site+'">'+t.data[n].libelle_site+"</option>";s+="</select>",e.innerHTML=s}).catch(t=>{e.innerHTML=t})},t=>{O.innerHTML="Geolocation error",e.innerHTML=""},D)}),W.addEventListener("click",t=>{B.innerHTML="",e.innerHTML="&#9203;";var n=y.value,s=j.value,o=g.value,i="https://hubeau.eaufrance.fr/api/v1/hydrometrie/referentiel/sites?latitude="+s+"&longitude="+o+"&distance="+n;const a=new Request(i);fetch(a).then(e=>{if(!e.ok)throw new Error("Request error");return e.json()}).then(t=>{if(t.data.length==0){hydrosites.innerHTML="No sites found";return}for(var s='<select id="siteSelect">',n=0;n<t.data.length;n++)s+='<option value="'+t.data[n].code_site+'">'+t.data[n].libelle_site+"</option>";s+="</select>",e.innerHTML=s}).catch(t=>{e.innerHTML=t})}),P.addEventListener("click",e=>{t.innerHTML="&#9203;";const n=document.getElementById("siteSelect");if(n==null){t.innerHTML="Error";return}var s=n.value,o="https://hubeau.eaufrance.fr/api/v1/hydrometrie/referentiel/stations?code_site="+s;const i=new Request(o);fetch(i).then(e=>{if(!e.ok)throw new Error("Request error");return e.json()}).then(e=>{if(e.data.length==0){t.innerHTML="No stations found";return}toInsert='<select id="stationSelect">';for(var n=0;n<e.data.length;n++)toInsert+='<option value="'+e.data[n].code_station+'">'+e.data[n].libelle_station+"</option>";toInsert+="</select>",t.innerHTML=toInsert}).catch(e=>t.innerHTML=e)}),F.addEventListener("click",n=>{i.innerHTML="&#9203;";const s=document.getElementById("stationSelect");if(s==null){i.innerHTML="Error";return}try{var a=s.value,o=s.options[s.selectedIndex].innerHTML;localStorage.setItem("hydroStationId",a),localStorage.setItem("hydroStationName",o)}catch{i.innerHTML="Save error";return}i.innerHTML="Settings saved",e.innerHTML="",t.innerHTML="",g.value="",j.value="",A()});const L=document.getElementById("settingsGearA"),R=document.getElementById("trendsSettingsA"),M=document.getElementById("rssSettingsA"),H=document.getElementById("hydroSettingsA"),I=document.getElementById("closeSettingsA");function a(e="trendsSettingsTab"){var t,n=["trendsSettingsTab","rssSettingsTab","hydroSettingsTab"];if(n.includes(e)){for(t=0;t<n.length;t++)document.getElementById(n[t]).style.display="none";document.getElementById(e).style.display="block"}else return}async function u(){c.innerHTML="",o.selectedIndex=0,_(),r.innerHTML="",n.selectedIndex=0,C(),s.innerHTML="",f.value="",p.value="",w(),i.innerHTML="",e.innerHTML="",t.innerHTML="",g.value="",j.value="",A()}L.addEventListener("click",e=>k()),I.addEventListener("click",e=>k()),R.addEventListener("click",e=>a()),M.addEventListener("click",e=>a("rssSettingsTab")),H.addEventListener("click",e=>a("hydroSettingsTab")),defaultsA.addEventListener("click",e=>{if(confirm("Restore defaults ?"))try{localStorage.setItem("trendsRegionName","France"),localStorage.setItem("trendsRegionId","FR"),localStorage.setItem("bleuEditionName","Bourgogne"),localStorage.setItem("bleuEditionId","bourgogne"),localStorage.setItem("customRssName","Mairie Semur en Auxois"),localStorage.setItem("customRssUrl","https://www.ville-semur-en-auxois.fr/feed/?post_type=post"),localStorage.setItem("hydroStationId","F330000101"),localStorage.setItem("hydroStationName","L'Armançon à Pont-et-Massène [Barrage] - Aval barrage"),u(),alert("Defaults restored.")}catch(e){alert(e)}else return});async function $(){await u(),await S()}const x=document.getElementById("loadingDiv"),K=document.getElementById("grattoirDiv");async function U(){x.innerHTML="<h1>&#9203;</h1>",await $(),x.style.display="none"}U()}grattoirEntry()</script>