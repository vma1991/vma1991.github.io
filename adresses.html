
<!doctype html>
<html lang="fr">

	<head>
		<title>vma1991</title>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="style.css">
	</head>

	<body>
		<div id="pages-icon">
			<a href="http://vma1991.github.io">
				<img src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJ
bWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdp
bj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6
eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0
NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJo
dHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlw
dGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAv
IiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RS
ZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpD
cmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFu
Y2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9j
dW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBN
TTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5
QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDEx
RTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4
bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlB
K46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWd
PHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04
XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6m
hIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMF
kThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89
O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJob
wMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1
pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasC
nL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4
WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJ
XeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZ
kWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJ
dN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6
WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5E
rkJggg==">
			</a>
		</div>

		<h3><a href="index.html">vma1991<sub>.github.io</sub></a></h3>

		<h3>Recherche d&apos;adresses (FR)</h3>

		<p><i>Limit&eacute; &agrave; 10 r&eacute;sultats</i></p>

		<script type="text/javascript">

			const contentDiv = document.createElement('div');
			document.body.appendChild(contentDiv);

			const searchInput = document.createElement('input');
			searchInput.setAttribute("type", "text");
			searchInput.size = 40;
			searchInput.addEventListener('keypress', e => {
				if (e.key == 'Enter') { 
					goSearch(); 
				}
			});
			contentDiv.appendChild(searchInput);

			const searchButton = document.createElement('button');
			searchButton.textContent = 'Go';
			searchButton.addEventListener('click', goSearch);

			contentDiv.insertAdjacentHTML('beforeend', ' ');
			contentDiv.appendChild(searchButton);

			const resultsDiv = document.createElement('div');
			document.body.appendChild(resultsDiv);

			/////

			function escapeSearchString(searchString){
				var toReturn = searchString.toLowerCase();
				toReturn = toReturn.replaceAll(' ', '+');
				toReturn = encodeURI(toReturn);
				toReturn = toReturn.replaceAll('\'', '\\\'');
				return(toReturn);
			}

			function goSearch(){
				resultsDiv.replaceChildren();
				resultsDiv.insertAdjacentHTML('beforeend', '<p>Fetching data &#9203;<p>')
				const reqUrl = 'https://api-adresse.data.gouv.fr/search?q=' + escapeSearchString(searchInput.value) + '&limit=10';
				const apiReq = new Request(reqUrl);
				const jsonReq = fetch(apiReq).then(response => response.json());
				jsonReq.then(data => displayAdresses(data))
					.catch(e => resultsDiv.insertAdjacentHTML('beforeend', '<p>' + e + '</p>'));
			}

			function displayAdresses(data){
				if ('features' in data && data.features.length > 0){
					var toInsert = '<p>';
					for (var i = 0 ; i < data.features.length ; i++){
						toInsert += data.features[i].properties.label + '<br>'
					}
					toInsert += '</p>'
					resultsDiv.replaceChildren();
					resultsDiv.insertAdjacentHTML('beforeend', toInsert);
				}
				else {
					resultsDiv.replaceChildren();
					resultsDiv.insertAdjacentHTML('beforeend', '<p>No results..</p>')
				}
			}


		</script>

	</body>

</html>
